<!DOCTYPE html><html lang=en manifest=/manifest.appcache><head><meta charset=utf-8><title>Plugins &middot; Vanilla Documentation</title><meta name=description content=""><meta name=keywords content=""><meta name=viewport content="width=device-width"><meta name=google-site-verification content=IWfWjN_f_82e7heCa9D0SJRhIf8aZdPNKZm_ympcB54><link rel=stylesheet href=/assets/main.4f4cd87b.css><body><div id=top></div><nav class="navbar navbar-default navbar-static-top" role=navigation><div class=container><div class=navbar-header><a class=navbar-brand href="/"><img class=logo src=/assets/img/logo.9bdefa97.svg alt="Vanilla Forums" width=102 height=41> Docs</a></div><div class="collapse navbar-collapse"><div class="navbar-form navbar-left"><div class="dropdown js-search" role=search><div class=form-group><input class="form-control js-search-input" id=docs-search title="Search the documentation" placeholder=Search></div><ul class="dropdown-menu dropdown-search-results js-search-results"><li><a><span class=title></span> <span class=categories></span></a></li></ul></div></div><ul class="nav navbar-nav navbar-right"><li><a href=http://vanillaforums.com>Cloud Hosted Community</a></li><li><a href=http://vanillaforums.org>Open Source Community</a></li></ul></div></div></nav><div class=container><ol class=breadcrumb><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/" itemprop=url><span itemprop=title>Home</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/developers/" itemprop=url><span itemprop=title>Developers</span></a></li><li class=active itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span itemprop=title>Plugins</span></li></ol><div class=row><div class=col-sm-3><nav class="docs-nav js-docs-nav" role=navigation><ul class="nav nav-stacked"><li><a href="/addons/">Addons</a><ul class="nav nav-stacked"><li><a href="/addons/badges/">Badges</a><ul class="nav nav-stacked"><li><a href="/addons/badges/adding-and-editing-badges/">Adding and Editing Badges</a></li><li><a href="/addons/badges/giving-and-requesting-badges/">Giving and Requesting Badges</a></li></ul></li><li><a href="/addons/warnings-and-notes/">Warnings &amp; Notes</a><ul class="nav nav-stacked"><li><a href="/addons/warnings-and-notes/adding-and-editing-user-notes/">Adding and Editing User Notes</a></li><li><a href="/addons/warnings-and-notes/upgrading-from-warnings/">Upgrading from Warnings</a></li><li><a href="/addons/warnings-and-notes/warning-a-user/">Warning a User</a></li></ul></li><li><a href="/addons/gigya/">Gigya Sign In</a></li><li><a href="/addons/googleplus/">Google Plus</a></li><li><a href="/addons/groups/">Groups</a><ul class="nav nav-stacked"><li><a href="/addons/groups/managing-groups/">Managing Groups</a></li></ul></li><li><a href="/addons/pockets/">Pockets</a></li><li><a href="/addons/forummerge/">Forum Merge</a></li><li><a href="/addons/reactions/">Reactions</a><ul class="nav nav-stacked"><li><a href="/addons/reactions/adding-and-editing-reactions/">Adding and Editing Reactions</a></li><li><a href="/addons/reactions/curating-with-reactions/">Curating with Reactions</a></li></ul></li><li><a href="/addons/redirector/">Redirector</a></li><li><a href="/addons/reporting/">Reporting</a></li><li><a href="/addons/statistics/">Statistics</a></li><li><a href="/addons/vanilla-pop/">Vanilla Pop</a></li><li><a href="/addons/ranks/">Ranks</a><ul class="nav nav-stacked"><li><a href="/addons/ranks/adding-and-editing-ranks/">Adding and Editing Ranks</a></li><li><a href="/addons/ranks/applying-ranks-over-sso/">Applying Ranks over SSO</a></li><li><a href="/addons/ranks/using-ranks-as-incentives/">Using Ranks as Incentives</a></li><li><a href="/addons/ranks/using-ranks-to-defeat-spam-or-abuse/">Using Ranks to Defeat Spam or Abuse</a></li></ul></li></ul></li><li><a href="/api/">API</a><ul class="nav nav-stacked"><li><a href="/api/smart-id/">Smart ID</a></li><li><a href="/api/categories/">Categories</a></li><li><a href="/api/comments/">Comments</a></li><li><a href="/api/discussions/">Discussions</a></li><li><a href="/api/forum-administration/">Forum Administration</a></li><li><a href="/api/roles/">Roles</a></li><li><a href="/api/site-hub/">Site Hub</a></li><li><a href="/api/use-api-on-external-site/">API on External Sites</a></li></ul></li><li><a href="/cloud/">Cloud Services</a><ul class="nav nav-stacked"><li><a href="/cloud/integration/">Integration Services</a></li><li><a href="/cloud/logging/">Logging</a></li><li><a href="/cloud/migration/">Migration Services</a></li><li><a href="/cloud/multisite/">Multisite Features</a><ul class="nav nav-stacked"><li><a href="/cloud/multisite/sync/">Multisite Features</a></li></ul></li><li><a href="/cloud/repo/">Repository</a></li><li><a href="/cloud/ssl/">Setting up SSL (https)</a></li><li><a href="/cloud/staging/">Staging Site</a></li><li><a href="/cloud/support/">Support</a></li><li><a href="/cloud/theming/">Theming Services</a></li></ul></li><li class=active><a href="/developers/">Developers</a><ul class="nav nav-stacked"><li><a href="/developers/changelog/">Changelog</a></li><li><a href="/developers/troubleshooting/">Troubleshooting</a></li><li><a href="/developers/configuration/">Configuration</a><ul class="nav nav-stacked"><li><a href="/developers/configuration/banner/">Banner Settings</a></li><li><a href="/developers/configuration/dashboard/">Dashboard</a></li><li><a href="/developers/configuration/homepage/">Homepage Settings</a></li><li><a href="/developers/configuration/message/">Messages</a></li><li><a href="/developers/configuration/using/">Using The Config</a></li></ul></li><li><a href="/developers/contributing/">Contributing</a><ul class="nav nav-stacked"><li><a href="/developers/contributing/coding-standard/">Coding Standard</a></li><li><a href="/developers/contributing/conduct/">Code of Conduct</a></li><li><a href="/developers/contributing/pull-requests/">Pull Requests</a></li></ul></li><li><a href="/developers/data-privacy/">Data privacy</a></li><li><a href="/developers/framework/">Framework</a><ul class="nav nav-stacked"><li><a href="/developers/framework/assets/">Assets</a></li><li><a href="/developers/framework/views/">Views</a></li><li><a href="/developers/framework/database/">Database access</a></li><li><a href="/developers/framework/datasets/">Datasets</a></li><li><a href="/developers/framework/email/">Email</a></li><li><a href="/developers/framework/helpers/">Helpers</a></li><li><a href="/developers/framework/controllers/">Controllers &amp; URLs</a></li><li><a href="/developers/framework/inform/">Inform Messages</a></li><li><a href="/developers/framework/models/">Models, Forms, &amp; Validation</a></li><li><a href="/developers/framework/modules/">Modules</a></li><li><a href="/developers/framework/permissions/">Permissions</a></li><li><a href="/developers/framework/requests/">Requests</a></li><li><a href="/developers/framework/i18n/">Internationalization &amp; Localization</a></li></ul></li><li><a href="/developers/community/">Community</a></li><li><a href="/developers/installation/">Installation</a></li><li><a href="/developers/locales/">Locales</a></li><li class=active><a href="/developers/plugins/">Plugins</a><ul class="nav nav-stacked"><li><a href="/developers/plugins/quickstart/">Plugin Quickstart</a></li></ul></li><li><a href="/developers/routes/">Routes</a></li><li><a href="/developers/tools/">Developer Tools</a></li><li><a href="/developers/importing/">Importing</a><ul class="nav nav-stacked"><li><a href="/developers/importing/build/">Building new porters</a></li><li><a href="/developers/importing/porter/">Vanilla Porter</a></li><li><a href="/developers/importing/support/">Supported platforms</a></li></ul></li></ul></li><li><a href="/features/">Features</a><ul class="nav nav-stacked"><li><a href="/features/categories/">Categories</a></li><li><a href="/features/comments/">Universal Comments</a></li><li><a href="/features/emails/">Emails</a></li><li><a href="/features/embedding/">Embedding</a><ul class="nav nav-stacked"><li><a href="/features/embedding/advanced/">Advanced Embedding</a></li></ul></li><li><a href="/features/emoji/">Emoji</a></li><li><a href="/features/roles-permissions/">Roles &amp; Permissions</a><ul class="nav nav-stacked"><li><a href="/features/roles-permissions/default-role-types/">Default Role Types</a></li></ul></li><li><a href="/features/sso/">Single Sign-On (SSO)</a><ul class="nav nav-stacked"><li><a href="/features/sso/jsconnect/">SSO with jsConnect</a><ul class="nav nav-stacked"><li><a href="/features/sso/jsconnect/embed/">Embedded</a></li><li><a href="/features/sso/jsconnect/overview/">Technical Overview</a></li><li><a href="/features/sso/jsconnect/seamless/">Seamless Setup</a></li></ul></li><li><a href="/features/sso/oauth/">SSO with OAuth</a></li><li><a href="/features/sso/saml/">SSO with SAML</a></li></ul></li><li><a href="/features/wordpress/">WordPress Integration</a><ul class="nav nav-stacked"><li><a href="/features/wordpress/using-comments/">Using Comments</a></li><li><a href="/features/wordpress/wishlist/">WishList Integration</a></li></ul></li></ul></li><li><a href="/theming/">Theming</a><ul class="nav nav-stacked"><li><a href="/theming/css/">Theming CSS</a></li><li><a href="/theming/hooks/">Theming Hooks</a></li><li><a href="/theming/quickstart/">Theming Quickstart</a></li><li><a href="/theming/smarty/">Smarty</a><ul class="nav nav-stacked"><li><a href="/theming/smarty/conditionals/">Smarty Conditionals</a></li><li><a href="/theming/smarty/functions/">Smarty Functions</a><ul class="nav nav-stacked"><li><a href="/theming/smarty/functions/asset/">{asset}</a></li><li><a href="/theming/smarty/functions/text/">{text}</a></li><li><a href="/theming/smarty/functions/custom-menu/">{custom_menu}</a></li><li><a href="/theming/smarty/functions/event/">{event}</a></li><li><a href="/theming/smarty/functions/i18n/">{t}</a></li><li><a href="/theming/smarty/functions/include-file/">{include_file}</a></li><li><a href="/theming/smarty/functions/link/">{link}</a></li><li><a href="/theming/smarty/functions/breadcrumbs/">{breadcrumbs}</a></li><li><a href="/theming/smarty/functions/mobile-logo/">{mobile_logo}</a></li><li><a href="/theming/smarty/functions/module/">{module}</a></li><li><a href="/theming/smarty/functions/page-links/">Page Links</a></li><li><a href="/theming/smarty/functions/permission/">{permission}</a></li><li><a href="/theming/smarty/functions/pocket/">{pocket}</a></li><li><a href="/theming/smarty/functions/searchbox/">{searchbox}</a></li><li><a href="/theming/smarty/functions/logo/">{logo}</a></li></ul></li><li><a href="/theming/smarty/modifiers/">Smarty Modifiers</a></li></ul></li><li><a href="/theming/themeoptions/">Theme Options</a></li><li><a href="/theming/views/">Theming Views</a></li></ul></li></ul><p class=hidden-xs><a class=text-muted href=#top>^ Back to top</a></p></nav></div><div class=col-sm-9><div class="edit-doc pull-right hidden-xs"><a class="btn btn-default btn-xs" href=https://github.com/vanilla/vanilladocs/edit/master/docs/developers/plugins/index.html.md>Improve document</a></div><article class=markdown-body role=article><h1 id=extending-vanilla-with-plugins>Extending Vanilla with plugins</h1><p>Vanilla is a very customizable, flexible platform because there are many ways to hook into it without ever modifying its code.</p><h2 id=events-handlers>Events &amp; Handlers</h2><p>Any class that extends the class &quot;Pluggable&quot; has the ability to call</p><pre class=highlight><code class="hljs elixir"><span class=hljs-variable>$this</span>-&gt;fireEvent(<span class=hljs-string>'EventName'</span>);
</code></pre><p>and then plugins can attach to that event to perform an action.</p><p>There is a PluginManager that detects any enabled plugins. When the <code>FireEvent</code> method is called, it pings the PluginManager class to see if there are any plugins that want to attach to the event name being fired.</p><p>Plugins attach to an event by creating a method named with the object name, event name, and the word <code>handler</code> separated by underscores. Say the <code>DiscussionsController</code> fired an event named &#39;Kaboom&#39;. Here is how you would use it:</p><pre class=highlight><code class="hljs scala"><span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>MyPlugin</span> <span class=hljs-keyword><span class=hljs-keyword>extends</span></span> <span class=hljs-title>GDN_Plugin</span>(</span>) {
   public function discussionsController_kaboom_handler($sender, $args) {
         <span class=hljs-comment>// Do stuff at the 'Kaboom' event here.</span>
         $sender-&gt;index(); <span class=hljs-comment>// You can invoke DiscussionsController methods here.</span>
   }
}
</code></pre><p>Notice that 2 parameters are passed. The first is the object invoking the event (usually <code>$this</code>). The second is <em>optional</em>, and is an array of event arguments being passed as additional info or options to be modified.</p><h2 id=eventarguments>EventArguments</h2><p>Usually these arguments are the data being set up by the object, a toggle the handler can switch on or off, or other contextual info.</p><p>For example:</p><pre class=highlight><code class="hljs elixir"><span class=hljs-variable>$this</span>-&gt;<span class=hljs-constant>EventArguments[</span><span class=hljs-string>'DuckDodgers'</span>] &amp;= <span class=hljs-string>'24.5'</span>;
<span class=hljs-variable>$this</span>-&gt;fireEvent(<span class=hljs-string>'Kaboom'</span>);
</code></pre><p>Now in our <code>Handler</code> method above, $args would be an array of <code>&#39;DuckDodgers&#39; =&gt; &#39;24.5&#39;</code>. If we set <code>$args[&#39;DuckDodgers&#39;] = 0;</code> in our <code>handler</code> method, it would also be changed back in the <code>DiscussionsController</code> because it was passed by reference.</p><p>To invoke a handler on ALL methods, use the prefix <code>base</code> instead of an object name. Example: <code>base_kaboom_handler</code>. It is best to avoid unnecessary calls by using this <em>very</em> conservatively.</p><p>Custom events are added on a case-by-case basis as the need arises. If you feel you need a new event, request it on the community forum.</p><h2 id=magic-events>Magic Events</h2><p>Magic events were an elaborate system of hook possibilities that involved the method prefix &#39;x&#39; and PHP&#39;s <code>__call()</code> method. Currently, there is only one undeprecated magic event in Vanilla: <code>render_before</code>. It invokes just before the page is rendered. Example use: <code>base_render_before($Sender)</code>. <strong>It is best to avoid when another event is usable.</strong></p><p>For a better alternative hook that reliably fires early on every request, try <code>gdn_dispatcher_appStartup_handler</code> instead. To universally include a CSS file, use <code>assetModel_styleCss_handler</code>.</p><h2 id=function-overrides>Function Overrides</h2><p>All functions in the framework are declared like so:</p><pre class=highlight><code class="hljs actionscript"><span class=hljs-keyword>if</span> (!function_exists(<span class=hljs-string>'functionName'</span>)) {
   <span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>functionName</span><span class=hljs-params>()</span> </span>{
         <span class=hljs-comment>// Do something.</span>
   }
}
</code></pre><p>Plugin authors may therefore override any core function simply by defining it in a plugin or theme hook file, which are included before the core functions.</p><h2 id=magic-methods>Magic Methods</h2><p>Magic methods allow you to create new methods and add them to existing objects. They are created in much the same way that you plug into events. Imagine you wanted to add a method named <code>Kaboom</code> to the DiscussionsController:</p><pre class=highlight><code class="hljs scala"><span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>MyPlugin</span> <span class=hljs-keyword><span class=hljs-keyword>extends</span></span> <span class=hljs-title>Gdn_Plugin</span> {</span>
   public function discussionsController_kaboom_create($<span class=hljs-type>Sender</span>) {
        echo <span class=hljs-string>"Kaboom!"</span>;
   }
}
</code></pre><p>With this plugin enabled, going to the URL <code>/discussions/kaboom</code> would now output the text &quot;Kaboom!&quot;. You can references other methods and properties on the extended object using the <code>$Sender</code> variable.</p><p>If you use a magic method to duplicate an existing method name, it will be overridden completely. And call to it will be directed to your plugin instead. The only exception is the <code>Index()</code> method.</p><p>Magic methods only work in classes that extend <code>Gdn_Pluggable</code>. For example, notice the <code>Gdn_Form</code> class does, but the <code>Gdn_Format</code> class does not. All models and controllers do.</p><h2 id=controllers>Controllers</h2><p>Is your addon a bit more complex? Add a <code>controllers</code> folder and add your own controller classes. They will automatically be detected and be dispatched to like normal controllers. This functionality is new in Vanilla 2.2.</p><p>As a reminder, controllers should extend Gdn_Controller. <a href=/developers/framework/controllers>Read more about controllers</a>.</p><h2 id=virtual-controller-deprecated->Virtual Controller (deprecated)</h2><p>A virtual controller let you simulate a single controller within a plugin. First, create a magic method using the namespace you want for your controller. Example: <code>pluginController_newNamespace_create</code>. This creates content under the URL <code>/plugin/newnamespace</code>. To put NewNamespace as the first level (instead of under &quot;plugins&quot;) use the RootController. End the magic method with a re-dispatch: <code>$this-&gt;dispatch($Sender, $Sender-&gt;RequestArgs);</code>.</p><p>Next, create methods named <code>Controller_X</code>, where X is the method namespace. Example: <code>controller_index($Sender)</code>.</p><p>Let&#39;s put it all together with a quick example. Let&#39;s say you wanted to create content at <code>/fancy/ping</code>. This would accomplish that:</p><pre class=highlight><code class="hljs xml"><span class=php><span class=hljs-preprocessor>&lt;?php</span>
<span class=hljs-comment>/**
 * File-level doc blocks are for<span class=hljs-phpdoc> @license</span>,<span class=hljs-phpdoc> @copyright</span>, and<span class=hljs-phpdoc> @author</span> tags.
 */</span>

<span class=hljs-comment>/**
 * Class-level doc blocks should summarize what the class is for.
 */</span>
<span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>MyFancyPlugin</span> <span class=hljs-keyword>extends</span> <span class=hljs-title>Gdn_Plugin</span> () </span>{

    <span class=hljs-comment>/**
     * Always document your methods.
     */</span>
   <span class=hljs-keyword>public</span> <span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>rootController_fancy_create</span><span class=hljs-params>(<span class=hljs-variable>$Sender</span>)</span> </span>{
          <span class=hljs-comment>// This is a good place to check permissions or include assets.</span>
       <span class=hljs-variable>$this</span>-&gt;dispatch(<span class=hljs-variable>$Sender</span>, <span class=hljs-variable>$Sender</span>-&gt;RequestArgs);
   }

    <span class=hljs-comment>/**
     * Include<span class=hljs-phpdoc> @param</span> and<span class=hljs-phpdoc> @return</span> in your docs too.
     */</span>
   <span class=hljs-keyword>public</span> <span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>controller_ping</span><span class=hljs-params>(<span class=hljs-variable>$Sender</span>)</span> </span>{
       <span class=hljs-comment>// This is what happens when you call /fancy/ping.</span>
   }
}
</span></code></pre><p>This is obviously more resource-intense than a normal controller, so avoid this technique if normal controllers are available to you and/or you need more than one controller. This technique was obsoleted by adding native controllers to plugins in 2.2.</p></article></div></div></div><footer class="footer js-footer"><div class=jumbotron><div class=container><div class=row><div class=col-sm-6><h3><a href=http://vanillaforums.com>Cloud Hosting</a></h3><p><strong>We believe that online communities should be intuitive, engaging and true to your brand.</strong> Vanilla allows you to create a customized community that rewards positive participation, automatically curates content and lets members drive moderation.</p></div><div class=col-sm-6><h3><a href=http://vanillaforums.org>Open Source</a></h3><p>Vanilla provides cloud and open source community forum software that powers discussion forums on more than 700,000 sites. Built for flexibility and integration, <strong>Vanilla is the best, most powerful community solution in the world.</strong></p></div></div></div></div><div class=footer-copyright><div class=container><p class=text-center>Copyright &copy; 2009-2016 <a href=http://vanillaforums.com>Vanilla Forums Inc.</a> All rights reserved.</p><ul class="list-inline text-center hidden-xs"><li><a href=http://docs.vanillaforums.com>Docs</a></li><li><a href=http://blog.vanillaforums.com>Blog</a></li><li><a href=http://vanillaforums.com>Cloud</a></li><li><a href=http://vanillaforums.org>Community</a></li><li><a href=https://github.com/vanilla>GitHub</a></li><li><a href=https://github.com/vanilla/vanilla/issues>Issues</a></li></ul></div></div></footer><script src=/search.8e9b4d8a.json id=search-manifest type=application/json></script><script src=/assets/main.0534788e.js></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-12713112-1","auto"),ga("send","pageview");</script>