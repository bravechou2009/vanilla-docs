<!DOCTYPE html><html lang=en manifest=/manifest.appcache><head><meta charset=utf-8><title>Technical Overview &middot; Vanilla Documentation</title><meta name=description content=""><meta name=keywords content=""><meta name=viewport content="width=device-width"><meta name=google-site-verification content=IWfWjN_f_82e7heCa9D0SJRhIf8aZdPNKZm_ympcB54><link rel=stylesheet href=/assets/main.951d969c.css><body><div id=top></div><nav class="navbar navbar-default navbar-static-top" role=navigation><div class=container><div class=navbar-header><a class=navbar-brand href="/"><img class=logo src=/assets/img/logo.9bdefa97.svg alt="Vanilla Forums" width=102 height=41> Docs</a></div><div class="collapse navbar-collapse"><div class="navbar-form navbar-left"><div class="dropdown js-search" role=search><div class=form-group><input class="form-control js-search-input" id=docs-search title="Search the documentation" placeholder=Search></div><ul class="dropdown-menu dropdown-search-results js-search-results"><li><a><span class=title></span> <span class=categories></span></a></li></ul></div></div><ul class="nav navbar-nav navbar-right"><li><a href=http://vanillaforums.com>Cloud Hosted Community</a></li><li><a href=http://vanillaforums.org>Open Source Community</a></li></ul></div></div></nav><div class=container><ol class=breadcrumb><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/" itemprop=url><span itemprop=title>Home</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/features/" itemprop=url><span itemprop=title>Features</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/features/sso/" itemprop=url><span itemprop=title>Single Sign-On (SSO)</span></a></li><li itemscope itemtype=http://data-vocabulary.org/Breadcrumb><a href="/features/sso/jsconnect/" itemprop=url><span itemprop=title>SSO with jsConnect</span></a></li><li class=active itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span itemprop=title>Technical Overview</span></li></ol><div class=row><div class=col-sm-3><nav class="docs-nav js-docs-nav" role=navigation><ul class="nav nav-stacked"><li><a href="/addons/">Addons</a><ul class="nav nav-stacked"><li><a href="/addons/badges/">Badges</a><ul class="nav nav-stacked"><li><a href="/addons/badges/adding-and-editing-badges/">Adding and Editing Badges</a></li><li><a href="/addons/badges/giving-and-requesting-badges/">Giving and Requesting Badges</a></li></ul></li><li><a href="/addons/warnings-and-notes/">Warnings &amp; Notes</a><ul class="nav nav-stacked"><li><a href="/addons/warnings-and-notes/adding-and-editing-user-notes/">Adding and Editing User Notes</a></li><li><a href="/addons/warnings-and-notes/upgrading-from-warnings/">Upgrading from Warnings</a></li><li><a href="/addons/warnings-and-notes/warning-a-user/">Warning a User</a></li></ul></li><li><a href="/addons/gigya/">Gigya Sign In</a></li><li><a href="/addons/googleplus/">Google Plus</a></li><li><a href="/addons/groups/">Groups</a><ul class="nav nav-stacked"><li><a href="/addons/groups/managing-groups/">Managing Groups</a></li></ul></li><li><a href="/addons/pockets/">Pockets</a></li><li><a href="/addons/forummerge/">Forum Merge</a></li><li><a href="/addons/reactions/">Reactions</a><ul class="nav nav-stacked"><li><a href="/addons/reactions/adding-and-editing-reactions/">Adding and Editing Reactions</a></li><li><a href="/addons/reactions/curating-with-reactions/">Curating with Reactions</a></li></ul></li><li><a href="/addons/redirector/">Redirector</a></li><li><a href="/addons/reporting/">Reporting</a></li><li><a href="/addons/statistics/">Statistics</a></li><li><a href="/addons/vanilla-pop/">Vanilla Pop</a></li><li><a href="/addons/ranks/">Ranks</a><ul class="nav nav-stacked"><li><a href="/addons/ranks/adding-and-editing-ranks/">Adding and Editing Ranks</a></li><li><a href="/addons/ranks/applying-ranks-over-sso/">Applying Ranks over SSO</a></li><li><a href="/addons/ranks/using-ranks-as-incentives/">Using Ranks as Incentives</a></li><li><a href="/addons/ranks/using-ranks-to-defeat-spam-or-abuse/">Using Ranks to Defeat Spam or Abuse</a></li></ul></li></ul></li><li><a href="/api/">API</a><ul class="nav nav-stacked"><li><a href="/api/smart-id/">Smart ID</a></li><li><a href="/api/categories/">Categories</a></li><li><a href="/api/comments/">Comments</a></li><li><a href="/api/discussions/">Discussions</a></li><li><a href="/api/forum-administration/">Forum Administration</a></li><li><a href="/api/roles/">Roles</a></li><li><a href="/api/site-hub/">Site Hub</a></li><li><a href="/api/use-api-on-external-site/">API on External Sites</a></li></ul></li><li><a href="/cloud/">Cloud Services</a><ul class="nav nav-stacked"><li><a href="/cloud/integration/">Integration Services</a></li><li><a href="/cloud/logging/">Logging</a></li><li><a href="/cloud/migration/">Migration Services</a></li><li><a href="/cloud/multisite/">Multisite Features</a></li><li><a href="/cloud/repo/">Repository</a></li><li><a href="/cloud/ssl/">Setting up SSL (https)</a></li><li><a href="/cloud/staging/">Staging Site</a></li><li><a href="/cloud/support/">Support</a></li><li><a href="/cloud/theming/">Theming Services</a></li></ul></li><li><a href="/developers/">Developers</a><ul class="nav nav-stacked"><li><a href="/developers/changelog/">Changelog</a></li><li><a href="/developers/troubleshooting/">Troubleshooting</a></li><li><a href="/developers/configuration/">Configuration</a><ul class="nav nav-stacked"><li><a href="/developers/configuration/banner/">Banner Settings</a></li><li><a href="/developers/configuration/dashboard/">Dashboard</a></li><li><a href="/developers/configuration/homepage/">Homepage Settings</a></li><li><a href="/developers/configuration/message/">Messages</a></li><li><a href="/developers/configuration/using/">Using The Config</a></li></ul></li><li><a href="/developers/contributing/">Contributing</a><ul class="nav nav-stacked"><li><a href="/developers/contributing/coding-standard/">Coding Standard</a></li><li><a href="/developers/contributing/conduct/">Code of Conduct</a></li><li><a href="/developers/contributing/pull-requests/">Pull Requests</a></li></ul></li><li><a href="/developers/data-privacy/">Data privacy</a></li><li><a href="/developers/framework/">Framework</a><ul class="nav nav-stacked"><li><a href="/developers/framework/assets/">Assets</a></li><li><a href="/developers/framework/views/">Views</a></li><li><a href="/developers/framework/database/">Database access</a></li><li><a href="/developers/framework/datasets/">Datasets</a></li><li><a href="/developers/framework/email/">Email</a></li><li><a href="/developers/framework/helpers/">Helpers</a></li><li><a href="/developers/framework/controllers/">Controllers &amp; URLs</a></li><li><a href="/developers/framework/inform/">Inform Messages</a></li><li><a href="/developers/framework/models/">Models, Forms, &amp; Validation</a></li><li><a href="/developers/framework/modules/">Modules</a></li><li><a href="/developers/framework/permissions/">Permissions</a></li><li><a href="/developers/framework/requests/">Requests</a></li><li><a href="/developers/framework/i18n/">Internationalization &amp; Localization</a></li></ul></li><li><a href="/developers/community/">Community</a></li><li><a href="/developers/installation/">Installation</a></li><li><a href="/developers/locales/">Locales</a></li><li><a href="/developers/plugins/">Plugins</a><ul class="nav nav-stacked"><li><a href="/developers/plugins/quickstart/">Plugin Quickstart</a></li></ul></li><li><a href="/developers/routes/">Routes</a></li><li><a href="/developers/tools/">Developer Tools</a></li><li><a href="/developers/importing/">Importing</a><ul class="nav nav-stacked"><li><a href="/developers/importing/build/">Building new porters</a></li><li><a href="/developers/importing/porter/">Vanilla Porter</a></li><li><a href="/developers/importing/support/">Supported platforms</a></li></ul></li></ul></li><li class=active><a href="/features/">Features</a><ul class="nav nav-stacked"><li><a href="/features/categories/">Categories</a></li><li><a href="/features/comments/">Universal Comments</a></li><li><a href="/features/emails/">Emails</a></li><li><a href="/features/embedding/">Embedding</a><ul class="nav nav-stacked"><li><a href="/features/embedding/advanced/">Advanced Embedding</a></li></ul></li><li><a href="/features/emoji/">Emoji</a></li><li><a href="/features/roles-permissions/">Roles &amp; Permissions</a><ul class="nav nav-stacked"><li><a href="/features/roles-permissions/default-role-types/">Default Role Types</a></li></ul></li><li class=active><a href="/features/sso/">Single Sign-On (SSO)</a><ul class="nav nav-stacked"><li class=active><a href="/features/sso/jsconnect/">SSO with jsConnect</a><ul class="nav nav-stacked"><li><a href="/features/sso/jsconnect/embed/">Embedded</a></li><li class=active><a href="/features/sso/jsconnect/overview/">Technical Overview</a></li><li><a href="/features/sso/jsconnect/seamless/">Seamless Setup</a></li></ul></li><li><a href="/features/sso/oauth/">SSO with OAuth</a></li><li><a href="/features/sso/saml/">SSO with SAML</a></li></ul></li><li><a href="/features/wordpress/">WordPress Integration</a><ul class="nav nav-stacked"><li><a href="/features/wordpress/using-comments/">Using Comments</a></li><li><a href="/features/wordpress/wishlist/">WishList Integration</a></li></ul></li></ul></li><li><a href="/theming/">Theming</a><ul class="nav nav-stacked"><li><a href="/theming/css/">Theming CSS</a></li><li><a href="/theming/hooks/">Theming Hooks</a></li><li><a href="/theming/quickstart/">Theming Quickstart</a></li><li><a href="/theming/smarty/">Smarty</a><ul class="nav nav-stacked"><li><a href="/theming/smarty/asset/">{asset}</a></li><li><a href="/theming/smarty/text/">{text}</a></li><li><a href="/theming/smarty/custom-menu/">{custom_menu}</a></li><li><a href="/theming/smarty/event/">{event}</a></li><li><a href="/theming/smarty/i18n/">{t}</a></li><li><a href="/theming/smarty/link/">{link}</a></li><li><a href="/theming/smarty/breadcrumbs/">{breadcrumbs}</a></li><li><a href="/theming/smarty/mobile-logo/">{mobile_logo}</a></li><li><a href="/theming/smarty/permission/">{permission}</a></li><li><a href="/theming/smarty/pocket/">{pocket}</a></li><li><a href="/theming/smarty/searchbox/">{searchbox}</a></li><li><a href="/theming/smarty/logo/">{logo}</a></li></ul></li><li><a href="/theming/views/">Theming Views</a></li></ul></li></ul><p class=hidden-xs><a class=text-muted href=#top>^ Back to top</a></p></nav></div><div class=col-sm-9><div class="edit-doc pull-right hidden-xs"><a class="btn btn-default btn-xs" href=https://github.com/vanilla/vanilladocs/edit/master/docs/features/sso/jsconnect/overview.html.md>Improve document</a></div><article class=markdown-body role=article><h1 id=jsconnect-technical-overview>jsConnect Technical Overview</h1><p>For jsConnect to work you&#39;ll put some code on your site that identifies your users in a way that Vanilla can understand. Vanilla then requests this information when the user wants to sign in and synchronizes the user with Vanilla. This is done via <a href=http://en.wikipedia.org/wiki/JSONP>JSONP</a>, which allows us to send your cookies from your site to you and obtain login information.</p><p>Vanilla&#39;s web-based single sign on (SSO) has 2 parts:</p><ol><li>Your SSO endpoint (based on one of our example libraries) on <em>your</em> site.</li><li>Vanilla&#39;s jsConnect plugin.</li></ol><p>jsConnect pings your endpoint whenever it wants to know if a user is logged in on your site. It does this using the user&#39;s current session, so you can use your normal &quot;is logged in&quot; detection to determine this - nothing fancy here.</p><h2 id=your-endpoint>Your endpoint</h2><p>Your endpoint needs to say 1 of 3 things when it&#39;s called:</p><ol><li>The current user is a <strong>guest</strong> (not logged in).</li><li>User is logged in here, but this wasn&#39;t a secure request (no signature + timestamp), so here&#39;s their <strong>name &amp; photo only</strong>.</li><li>User is logged in AND this was securely requested, so here&#39;s <strong>all the user data</strong> (including email and a unique ID from your system, which are required).</li></ol><p>Our example libaries help you structure the output so that jsConnect can read it correctly. <strong>If we provide a client library that you can use then we highly recommend using it.</strong></p><p>These libraries are open source and maintained on Github:</p><ul><li><a href=https://github.com/vanillaforums/jsConnectPHP>PHP jsConnect client library</a></li><li><a href=https://github.com/vanillaforums/jsConnectRuby>Ruby jsConnect client library</a></li><li><a href=https://github.com/vanillaforums/jsConnectJava>Java jsConnect client library</a></li><li><a href=https://github.com/vanillaforums/jsConnectdotNet>.NET jsConnect client library</a></li></ul><p>All of these libraries have one file with all of the library code you&#39;ll need and one file that gives an example usage. They also have a readme that tells you which file is which. <em>Please note that these libraries don&#39;t support <a href=/features/sso/jsconnect/embed>embedded SSO</a>.</em></p><p>If your site is programmed in a language that doesn&#39;t have a client library then we provide documentation on our jsConnect protocol. Have a look at the <a href=/features/sso/jsconnect/seamless>jsConnect technical implementation</a>.</p><h2 id=how-jsconnect-maps-users>How jsConnect maps users</h2><p>After calling your endpoint and getting a &quot;signed in&quot; reply, jsConnect looks up the user. If they&#39;ve <em>already</em> used SSO, we&#39;ve permanently mapped their unique ID to our UserID, so we sign them into that account. If they <em>haven&#39;t</em> used SSO before, 1 of 3 things happens:</p><ol><li>If the email for the user has never been used on the forum, it makes them a new account using the data passed and signs them into it.</li><li>If the email is in use and <code>AutoConnect</code> is enabled, we will immediately sign them in (and permanently store the mapping).</li><li>If the email is in use and <code>AutoConnect</code> is NOT enabled, we will prompt the user for their forum password to confirm their identity. This is the default setting because it is safer to assume you haven&#39;t verified their email address.</li></ol><p>Vanilla Cloud customers should request Support enable <code>AutoConnect</code> if they desire it. That is an important component of a seamless experience.</p><h2 id=tightening-the-integration>Tightening the integration</h2><p>To get very tight SSO integration, you will also want to follow these steps. Always carefully test your <em>basic</em> SSO authentication <strong>before</strong> tightening your integration.</p><ol><li>Change your registration method to &#39;Connect&#39; to block non-SSO users from registering.</li><li>Set your sign-in, sign-out, and registration URLs under jsConnect&#39;s settings in your Dashboard.</li><li>Check &quot;Make this connection your default signin method.&quot;</li><li>When linking or redirecting signed-in users to your forum, use the <code>/sso</code> endpoint on the forum. This triggers jsConnect&#39;s user lookup <strong>on the connection with &quot;default sign in method&quot; selected</strong> without the user needing to click. Optionally, you can provide a <code>Target</code> parameter with a relative path to specify where they should ultimately land on the forum. Example: <code>http://forum.yoursite.com/sso?Target=/categories</code>. This is the final critical step in a fully seamless experience.</li><li>For seamless SSO on an embedded forum, see our <a href="http://blog.vanillaforums.com/jsconnect-technical-documentation-for-embedded-sso/">embedded SSO solution</a>.</li></ol><h2 id=testing-the-integration>Testing the integration</h2><p>Use the &quot;Test URL&quot; link under your jsConnect settings to see if your endpoint is returning a good response.</p><p>Try using your browser&#39;s Incognite/Private window mode for testing. This allows you to have a separate &quot;test&quot; session while you stay logged in as the administrator in your main session to make changes quickly.</p><h2 id=common-questions>Common questions</h2><p><strong>What do we do if SSO breaks and we&#39;re locked out?</strong></p><p>You can log back in using the &quot;hidden&quot; URL <code>/entry/password</code> to sign-in with an existing forum account. This page is never redirected for SSO.</p><p><strong>Can&#39;t we just add users over the API?</strong></p><p>We <em>strongly recommend against</em> adding users over the API. Using jsConnect and allowing it to add users as they sign-in is the most robust and reliable approach that will cause you the fewest issues.</p><p><strong>Can we use multiple SSO connections?</strong></p><p>Absolutely. However, only one can be the default, which is what will trigger when <code>/sso</code> is used.</p><p><strong>How do we have seamless sign-in for users who go directly to the forum?</strong></p><p>If you&#39;ve followed all the steps above, the only way a user can be not signed into the forum while signed into your main site is if they sign into your site separately and then manually visit the forum by typing in the address manually or clicking a browser bookmark. In this scenario, they would need to click a prompt to finish forum sign-in.</p><p><strong>How is sign-out handled?</strong></p><p>We bounce them to your sign-in page after they sign-out on the forum. To do the opposite, redirect users thru our sign-out page, again passing a <code>Target</code> parameter so they finish where you want them to.</p><p><strong>Does this work for native applications, non-web scenarios, or third-party products?</strong></p><p>No. jsConnect is purely a web-based SSO workflow for your existing login system. We have separate products for popular third-party platforms and non-web scenarios.</p><p><strong>Can we reverse-SSO to Vanilla via API to see if a user is logged in there?</strong></p><p>Not at this time.</p><p><strong>Can we use jsConnect without providing an email address?</strong></p><p>No. You absolutely must send an email, which is the only method for mapping users. If you are importing forum users without email addresses and need a way to map them over SSO, we recommend using dummy email addresses that follow a formula like <code>{uniqueID}</code>@yoursite.com.</p><p><strong>Our system has overlapping names but Vanilla needs unique ones. How can we handle this?</strong></p><p>We strongly recommend assigning them unique usernames in your system, then passing that unique username to jsConnect. Keep in mind that, for features like mentions and autocomplete to work, usernames must be unique and adhere to Vanilla&#39;s username restrictions. Passing a duplicate <code>Name</code> field for a new user over jsConnect will cause the connection to fail.</p><p><strong>Can we set roles over jsConnect?</strong></p><p>Yes, see our <a href=/features/sso/jsconnect/seamless>technical documentation</a> for more information.</p><p><strong>The settings &amp; endpoint response look correct now, but it&#39;s still not working or redirecting properly.</strong></p><p>Try clearing your cookies and browser cache and restarting your browser. Use Incognito/Private mode whenever possible. Also, beware of Firefox caching redirects; when in doubt, double-check a redirect using another browser.</p><p>Repeatedly attempting SSO with many sessions and accounts with changing settings can cause unexpected results. This isn&#39;t a problem users would ever run into day-to-day.</p></article></div></div></div><footer class="footer js-footer"><div class=jumbotron><div class=container><div class=row><div class=col-sm-6><h3><a href=http://vanillaforums.com>Cloud Hosting</a></h3><p><strong>We believe that online communities should be intuitive, engaging and true to your brand.</strong> Vanilla allows you to create a customized community that rewards positive participation, automatically curates content and lets members drive moderation.</p></div><div class=col-sm-6><h3><a href=http://vanillaforums.org>Open Source</a></h3><p>Vanilla provides cloud and open source community forum software that powers discussion forums on more than 700,000 sites. Built for flexibility and integration, <strong>Vanilla is the best, most powerful community solution in the world.</strong></p></div></div></div></div><div class=footer-copyright><div class=container><p class=text-center>Copyright &copy; 2009-2015 <a href=http://vanillaforums.com>Vanilla Forums Inc.</a> All rights reserved.</p><ul class="list-inline text-center hidden-xs"><li><a href=http://docs.vanillaforums.com>Docs</a></li><li><a href=http://blog.vanillaforums.com>Blog</a></li><li><a href=http://vanillaforums.com>Cloud</a></li><li><a href=http://vanillaforums.org>Community</a></li><li><a href=https://github.com/vanilla>GitHub</a></li><li><a href=https://github.com/vanilla/vanilla/issues>Issues</a></li></ul></div></div></footer><script src=/search.8f69681c.json id=search-manifest type=application/json></script><script src=/assets/main.b1c8020a.js></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-12713112-1","auto"),ga("send","pageview");</script>